<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reserva de Cine - Din√°mico</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../CSS/Butacas.css">
    <link rel="icon" href="../imagenes/logo.png" type="image/png">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../JS/Butacas.js"></script>
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-cinerostar py-0">
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center" href="../index.html">
                <div class="logo-container">
                    <img src="../imagenes/logo_cine.png" alt="CineBlast" class="site-logo img-fluid">
                </div>
            </a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="#navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                       <a class="nav-link" aria-current="page" href="../index.html">Inicio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="Peliculas.html">Pel√≠culas</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="Cines.html">Cines</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="Chocolateria.html">Chocolater√≠a</a>
                    </li>
                    <!-- Corporativo removido seg√∫n indicaciones -->
                </ul>
            </div>
        </div>
    </nav>

    <header class="bg-danger text-white py-3">
        <div class="container-fluid d-flex justify-content-between align-items-center">
            <a href="javascript:void(0);" onclick="window.location.href='Inicio_de_butacas.html' + window.location.search;" class="text-white text-decoration-none">
                <span class="fs-5 fw-bold ms-3" id="btn-atras"> &lt; Atr√°s</span>
            </a>
            <span class="fs-5 me-3" id="current-time-display"> üïí 05:00</span>
        </div>
    </header>

    <div class="container-fluid py-4">
        <div class="row">
                <div class="col-md-4 col-lg-3 mb-4">
                    <div class="movie-info-panel">
                        <div class="text-center">
                        </div>
                        <div class="movie-details">
                            <p class="mb-2 d-flex align-items-center">
                            </p>
                            <p class="mb-2 d-flex align-items-center">
                                <span class="material-icons me-2"></span>
                                <span id="current-entry-date"></span>
                            </p>
                            <p class="mb-2 d-flex align-items-center">
                                <span class="material-icons me-2"></span>
                                <span id="current-entry-time"></span>
                            </p>
                            <p class="mb-0 d-flex align-items-center">
                                <span class="material-icons me-2"></span>
                                <span>SALA: 02</span>
                            </p>
                        </div>
                    </div>
                </div>

            <div class="col-md-8 col-lg-9">
                <div class="steps-container mb-4">
                    <div class="progress progress-bar-thin">
                        <div class="progress-bar bg-danger progress-width-25" role="progressbar" title="Progreso del proceso de compra" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <div class="d-flex justify-content-between position-relative mt-3" id="step-bar">
                        <button class="btn btn-danger position-relative px-4 py-3" data-step="1">
                            <span class="step-number">1</span>
                            <span class="d-block">üí∫ Butacas</span>
                        </button>
                        <button class="btn btn-outline-secondary position-relative px-4 py-3" data-step="2">
                            <span class="step-number">2</span>
                            <span class="d-block">üéüÔ∏è Entradas</span>
                        </button>
                        <button class="btn btn-outline-secondary position-relative px-4 py-3" data-step="3">
                            <span class="step-number">3</span>
                            <span class="d-block">üóëÔ∏è Snacks</span>
                        </button>
                        <button class="btn btn-outline-secondary position-relative px-4 py-3" data-step="4">
                            <span class="step-number">4</span>
                            <span class="d-block">üí≤ Pago</span>
                        </button>
                    </div>
                </div>

                <div class="step-content" data-step="1">
                    <h5 class="fw-bold">1. Seleccione sus Asientos</h5>
                    <div class="seat-map-container">
                        <div class="pantalla mb-4 text-center py-2 border rounded">PANTALLA</div>
                        <div id="seat-map" class="d-flex justify-content-center">
                            </div>
                    </div>
                    <div class="d-flex justify-content-end align-items-center mt-5 me-5">
                        <p class="mb-0 me-3 fw-bold">Butacas: <span id="selected-seats-display">Ninguna</span></p>
                        <button class="btn btn-success btn-lg btn-siguiente" data-next-step="2" disabled>Siguiente ></button>
                    </div>
                </div>

                <div class="step-content d-none" data-step="2">
                    <h5 class="fw-bold">2. Elija el Tipo de Entradas</h5>
                    <div class="alert alert-warning" id="ticket-validation-msg">Debe seleccionar un total de <span id="required-tickets">0</span> entradas para las butacas elegidas.</div>
                    <div id="ticket-list">
                        </div>
                    <div class="d-flex justify-content-end align-items-center mt-5 me-5">
                        <p class="mb-0 me-3 fw-bold">Subtotal Entradas: S/<span id="total-entradas">0.00</span></p>
                        <button class="btn btn-success btn-lg btn-siguiente" data-next-step="3" disabled>Siguiente ></button>
                    </div>
                </div>


                <div class="step-content d-none" data-step="3">
                    <h5 class="fw-bold">3. Elija sus Snacks (Opcional)</h5>
                    <ul class="nav nav-tabs custom-tabs" role="tablist">
                        <li class="nav-item" role="presentation"><button class="nav-link active tab-button" data-bs-toggle="tab" data-bs-target="#popcorn-tab" type="button" role="tab" data-tab="popcorn">POP CORN</button></li>
                        <li class="nav-item" role="presentation"><button class="nav-link tab-button" data-bs-toggle="tab" data-bs-target="#bebidas-tab" type="button" role="tab" data-tab="bebidas">BEBIDAS</button></li>
                        <li class="nav-item" role="presentation"><button class="nav-link tab-button" data-bs-toggle="tab" data-bs-target="#combos-tab" type="button" role="tab" data-tab="combos">COMBOS</button></li>
                    </ul>
                    <div class="tab-content pt-3" id="snacksTabContent">
                        <div class="tab-pane fade show active" id="popcorn-tab" role="tabpanel">
                            <div class="row row-cols-2 row-cols-md-3 row-cols-lg-4 g-4 products-grid" id="popcorn-items">
                                <div class="col">
                                    <div class="snack-item">
                                        <img src="../imagenes/canchita_grande.jpg" alt="Pop Corn Grande" class="img-fluid mb-2" loading="lazy">
                                        <h5>Pop Corn Grande</h5>
                                        <p class="text-danger fw-bold">S/ 20.00</p>
                                        <div class="quantity-control justify-content-center"></div>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="snack-item">
                                        <img src="../imagenes/canchita_mediana.png" alt="Pop Corn Mediano" class="img-fluid mb-2" loading="lazy">
                                        <h5>Pop Corn Mediano</h5>
                                        <p class="text-danger fw-bold">S/ 15.00</p>
                                        <div class="quantity-control justify-content-center"></div>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="snack-item">
                                        <img src="../imagenes/canchita_peque√±a.png" alt="Pop Corn Peque√±o" class="img-fluid mb-2" loading="lazy">
                                        <h5>Pop Corn Peque√±o</h5>
                                        <p class="text-danger fw-bold">S/ 12.00</p>
                                        <div class="quantity-control justify-content-center"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="bebidas-tab" role="tabpanel">
                            <div class="row row-cols-2 row-cols-md-3 row-cols-lg-4 g-4 products-grid" id="bebidas-items">
                                <div class="col">
                                    <div class="snack-item">
                                        <img src="../imagenes/coca_cola.jpg" alt="Coca Cola" class="img-fluid mb-2" loading="lazy">
                                        <h5>Coca Cola</h5>
                                        <p class="text-danger fw-bold">S/ 8.00</p>
                                        <div class="quantity-control justify-content-center"></div>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="snack-item">
                                        <img src="../imagenes/inka_cola.webp" alt="Inca Kola" class="img-fluid mb-2" loading="lazy">
                                        <h5>Inca Kola</h5>
                                        <p class="text-danger fw-bold">S/ 8.00</p>
                                        <div class="quantity-control justify-content-center"></div>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="snack-item">
                                        <img src="../imagenes/sporade.jpg" alt="Sporade" class="img-fluid mb-2" loading="lazy">
                                        <h5>Sporade</h5>
                                        <p class="text-danger fw-bold">S/ 7.00</p>
                                        <div class="quantity-control justify-content-center"></div>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="snack-item">
                                        <img src="../imagenes/agua_san_mateo.jpg" alt="Agua San Mateo" class="img-fluid mb-2" loading="lazy">
                                        <h5>Agua San Mateo</h5>
                                        <p class="text-danger fw-bold">S/ 5.00</p>
                                        <div class="quantity-control justify-content-center"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="combos-tab" role="tabpanel">
                            <div class="row row-cols-2 row-cols-md-3 row-cols-lg-4 g-4 products-grid" id="combos-items">
                                <div class="col">
                                    <div class="snack-item">
                                        <img src="../imagenes/combo_1.webp" alt="Combo Familiar" class="img-fluid mb-2" loading="lazy">
                                        <h5>Combo Familiar</h5>
                                        <p>Pop Corn Grande + 4 Bebidas</p>
                                        <p class="text-danger fw-bold">S/ 45.00</p>
                                        <div class="quantity-control justify-content-center"></div>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="snack-item">
                                        <img src="../imagenes/combo_2.jpg" alt="Combo Parejas" class="img-fluid mb-2" loading="lazy">
                                        <h5>Combo Parejas</h5>
                                        <p>Pop Corn Mediano + 2 Bebidas</p>
                                        <p class="text-danger fw-bold">S/ 28.00</p>
                                        <div class="quantity-control justify-content-center"></div>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="snack-item">
                                        <img src="../imagenes/combo_3.jpg" alt="Combo Individual" class="img-fluid mb-2" loading="lazy">
                                        <h5>Combo Individual</h5>
                                        <p>Pop Corn Peque√±o + 1 Bebida</p>
                                        <p class="text-danger fw-bold">S/ 18.00</p>
                                        <div class="quantity-control justify-content-center"></div>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="snack-item">
                                        <img src="../imagenes/nachos_con_queso.jpg" alt="Combo Nachos" class="img-fluid mb-2" loading="lazy">
                                        <h5>Combo Nachos</h5>
                                        <p>Nachos con Queso + 2 Bebidas</p>
                                        <p class="text-danger fw-bold">S/ 25.00</p>
                                        <div class="quantity-control justify-content-center"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="d-flex justify-content-end align-items-center mt-5 me-5">
                        <p class="mb-0 me-3 fw-bold">Subtotal Snacks: S/<span id="total-snacks">0.00</span></p>
                        <button class="btn btn-success btn-lg btn-siguiente" data-next-step="4">Siguiente ></button>
                    </div>
                </div>
                
                <div class="step-content d-none" data-step="4">
                    <h5 class="fw-bold">4. Resumen de la Compra y Pago</h5>
                    <div class="card mb-3">
                        <div class="card-header bg-light fw-bold">Detalle de la Compra</div>
                        <ul class="list-group list-group-flush" id="resumen-lista">
                            </ul>
                    </div>
                    
                    <div class="alert alert-info">Presione "Pagar Ahora" para completar su informaci√≥n de facturaci√≥n y pago.</div>
                    
                    <div class="d-flex justify-content-end align-items-center mt-5 me-5">
                        <p class="mb-0 me-3 fw-bold fs-4">Total a Pagar: S/<span id="total-general">0.00</span></p>
                        <button class="btn btn-danger btn-lg" id="btn-iniciar-pago">Pagar Ahora</button>
                    </div>
                </div>
                
            </div>
        </div>
    </div>

    <div class="modal fade" id="paymentModal" tabindex="-1" aria-labelledby="paymentModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header bg-danger text-white">
            <h5 class="modal-title" id="paymentModalLabel">Finalizar Compra - Pago y Datos</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            
            <h6 class="fw-bold mb-3">1. Completa tus datos</h6>
            <div class="row g-3 mb-4">
                <div class="col-md-3">
                    <select id="doc-type-butacas" class="form-select">
                        <option>DNI</option>
                        <option>Carnet Ext.</option>
                        <option>Pasaporte</option>
                    </select>
                    <div class="invalid-feedback">Seleccione un tipo de documento.</div>
                </div>
                <div class="col-md-9">
                    <input id="doc-number-butacas" type="text" class="form-control" placeholder="N√∫mero de documento">
                    <div class="invalid-feedback">Ingrese su n√∫mero de documento.</div>
                </div>
                <div class="col-md-6">
                    <input id="first-name-butacas" type="text" class="form-control" placeholder="Nombre">
                    <div class="invalid-feedback">Ingrese su nombre.</div>
                </div>
                <div class="col-md-6">
                    <input id="last-name-butacas" type="text" class="form-control" placeholder="Apellido">
                    <div class="invalid-feedback">Ingrese su apellido.</div>
                </div>
                <div class="col-12">
                    <input id="email-butacas" type="email" class="form-control" placeholder="Correo electr√≥nico">
                    <div class="invalid-feedback">Ingrese un correo electr√≥nico v√°lido.</div>
                </div>
            </div>
            
            <h6 class="fw-bold mb-3">2. Tipo de Comprobante</h6>
            <div class="btn-group mb-4" role="group">
                <button type="button" class="btn btn-success">Boleta simple</button>
                <button type="button" class="btn btn-outline-success">Factura</button>
            </div>
            
            <h6 class="fw-bold mb-3">3. ¬øC√≥mo desea realizar su pago?</h6>
            <div class="form-check">
                <input class="form-check-input" type="radio" name="paymentOption" id="cardPayment" checked>
                <label class="form-check-label fw-bold" for="cardPayment">Pago con tarjeta de d√©bito/cr√©dito</label>
            </div>
            <div class="form-check mb-3">
                <input class="form-check-input" type="radio" name="paymentOption" id="yapePayment">
                <label class="form-check-label fw-bold" for="yapePayment">Pago con Yape en l√≠nea</label>
            </div>
            
            <div id="card-fields">
                <div class="row g-3">
                    <div class="col-12">
                        <input id="card-number-butacas" type="text" class="form-control" placeholder="N√∫mero de tarjeta">
                        <div class="invalid-feedback">Ingrese un n√∫mero de tarjeta v√°lido.</div>
                    </div>
                    <div class="col-md-4">
                        <input id="card-exp-butacas" type="text" class="form-control" placeholder="Vencimiento MM/AA">
                        <div class="invalid-feedback">Formato MM/AA o MM/YYYY.</div>
                    </div>
                    <div class="col-md-4">
                        <input id="card-cvv-butacas" type="text" class="form-control" placeholder="CVV">
                        <div class="invalid-feedback">C√≥digo CVV (3 o 4 d√≠gitos).</div>
                    </div>
                    <div class="col-md-4">
                        </div>
                    <div class="col-12">
                        <input id="card-name-butacas" type="text" class="form-control" placeholder="Nombre completo">
                        <div class="invalid-feedback">Ingrese el nombre tal como aparece en la tarjeta.</div>
                    </div>
                </div>
            </div>
            
            <hr class="my-4">
            
            <div class="form-check form-switch d-flex align-items-center mb-4">
                <input class="form-check-input me-2" type="checkbox" id="termsSwitch" checked>
                <label class="form-check-label" for="termsSwitch">Acepto los T√©rminos y Condiciones y Pol√≠tica de privacidad.</label>
            </div>
            
            <div class="d-flex justify-content-end align-items-center pt-3">
                <p class="mb-0 me-4 fw-bold fs-4">Total: S/<span id="modal-total-pago">0.00</span></p>
                <button type="button" id="confirm-pay-btn-butacas" class="btn btn-danger btn-lg">Pagar</button>
            </div>
            
          </div>
        </div>
      </div>
    <!-- Toasters moved inside body and deduplicated -->
    <div class="position-fixed top-0 end-0 p-3 toast-container">
        <div id="successToastButacas" class="toast align-items-center text-bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="d-flex">
                <div class="toast-body">
                    <div>Compra con √©xito</div>
                    <div class="mt-1">Pedido: <strong id="order-id-butacas"></strong></div>
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Cerrar"></button>
            </div>
        </div>
        <div id="errorToastButacas" class="toast align-items-center text-bg-danger border-0 mt-2" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="d-flex">
                <div id="errorToastBodyButacas" class="toast-body">Por favor complete los campos requeridos.</div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Cerrar"></button>
            </div>
        </div>
    </div>

</body>
</html>